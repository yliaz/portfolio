---
title: JavaScript ä¸­çš„ç»§æ‰¿
---

# ![javascript](https://zhuye-1308301598.file.myqcloud.com/icons/javascript.png) JavaScript ä¸­çš„ç»§æ‰¿

è¿™ç¯‡æ–‡ç« å€Ÿé‰´äº†[javaScript.info](https://zh.javascript.info/prototype-inheritance)ä¸­åŸå‹è¿™ä¸€ç« èŠ‚ï¼ŒåŸæ–‡è®²çš„è°ƒç†éå¸¸æ¸…æ™°ï¼Œå€¼å¾—ä¸€è¯»ã€‚

ç”±äºåŸæ–‡æ˜¯è‹±æ–‡ï¼Œæˆ‘å°†è¿™ä¸€ç« èŠ‚çš„ä¸¤ç¯‡æ–‡ç« ç¿»è¯‘æ±‡æ€»å¹¶åŠ å…¥ä¸€äº›è‡ªå·±çš„ç†è§£ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ç¯‡Blogã€‚

## åŸºäºåŸå‹çš„ç»§æ‰¿

- åœ¨ç¼–ç¨‹æ—¶ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å¯¹ä¸€äº›ä¸œè¥¿ï¼ˆçš„åŠŸèƒ½ï¼‰è¿›è¡Œæ‰©å±•ã€‚
- ä¾‹å¦‚ï¼Œç°åœ¨æœ‰ä¸€ä¸ªç”¨æˆ·å¯¹è±¡ï¼ˆuserï¼‰ï¼Œå®ƒåŒ…å«ä¸€äº›**å±æ€§**å’Œ**æ–¹æ³•**ï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿå¯¹å…¶ç¨åŠ ä¿®æ”¹å°±äº§ç”Ÿä¸¤ä¸ªå®ƒçš„å˜ä½“ï¼šç®¡ç†å‘˜å¯¹è±¡ï¼ˆadminï¼‰å’Œè®¿å®¢å¯¹è±¡ï¼ˆguestï¼‰ã€‚æˆ‘ä»¬æƒ³è¦é‡å¤ä½¿ç”¨userä¸­çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¸Œæœ›é€šè¿‡æ‹·è´çš„æ–¹å¼ï¼Œè€Œæ˜¯èƒ½å¤Ÿåœ¨å·²æœ‰çš„å¯¹è±¡çš„åŸºç¡€ä¸Šå»æ„å»ºè¿™ä¸¤ä¸ªæ–°çš„å¯¹è±¡ã€‚

- **åŸºäºåŸå‹çš„ç»§æ‰¿**æœºåˆ¶æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼



### [[prototype]]

- åœ¨JavaScriptä¸­ï¼Œ**å¯¹è±¡**æœ‰ä¸€ä¸ªç‰¹æ®Šçš„éšè—å±æ€§ï¼Œåä¸º `[[prototype]]`ï¼ˆåœ¨[ECMA-262æ–‡æ¡£](https://www.ecma-international.org/publications/standards/Ecma-262.htm)ä¸­æ˜¯è¿™æ ·å‘½åçš„ï¼‰ï¼Œå®ƒçš„å€¼è¦ä¹ˆä¸º `null`ï¼Œè¦ä¹ˆä¸ºä¸€ä¸ª**å¯¹è±¡**çš„å¼•ç”¨ã€‚å¦‚æœå®ƒçš„å€¼ä¸ºä¸€ä¸ª**å¯¹è±¡**çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ç§°ä¸ºåŸæ¥å¯¹è±¡çš„â€œä¸€ä¸ªåŸå‹â€ã€‚

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589436864845-91349209-1f2c-4738-acc6-13a19a4ed8de.png)



- **åŸå‹**æœ‰ç§ç¥å¥‡çš„é­”åŠ›ã€‚å½“æˆ‘ä»¬æƒ³ä»ä¸€ä¸ªå¯¹è±¡ä¸­è¯»å–æŸä¸ªå±æ€§çš„å€¼çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰å¯¹è±¡ä¸åŒ…å«è¿™ä¸ªå±æ€§ï¼ŒJavaScriptä¼šè‡ªåŠ¨å»å®ƒçš„åŸå‹ä¸­å¯»æ‰¾ã€‚åœ¨ç¼–ç¨‹çš„ä¸–ç•Œä¸­ï¼Œè¿™è¢«ç§°ä¸º**åŸºäºåŸå‹çš„ç»§æ‰¿**ã€‚ç”±å®ƒè¡ç”Ÿå‡ºäº†å¾ˆå¤šç‚«é…·çš„è¯­è¨€ç‰¹æ€§å’Œç¼–ç¨‹æŠ€å·§ã€‚
- [[prototype]]è¿™ä¸ªå±æ€§æ˜¯å†…ç½®çš„å¹¶ä¸”æ˜¯ä¸ªéšè—å±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶å¯ä»¥å€ŸåŠ©ä¸€äº›æ–¹æ³•è®©å®ƒç°èº«ã€‚

- å…¶ä¸­ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„åç§°ï¼š`__proto__`ã€‚

```javascript
// åŠ¨ç‰©
let animal = {
  eat: true
};

// å…”å…”ğŸ°
let rabbit = {
  jump: true
}

rabbit.__proto__ = animal

//          [[prototype]]
// rabbit  ===============>  animal
```

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589427872242-69239946-189c-4f26-ac2e-d572bd71b002.png)



â—ï¸`**__proto__**` **åªæ˜¯** `**[[prototype]]**` **çš„** `**getter**` **å’Œ** `**setter**` 

- éœ€è¦æ³¨æ„çš„æ˜¯ `__proto__` å¹¶ä¸æ˜¯ `[[prototype]]` æœ¬èº«ï¼Œè€Œæ˜¯å®ƒçš„ `getter` å’Œ `setter`ã€‚
- è¿™å…¶ä¸­æœ‰ä¸€äº›å†å²çš„å› ç´ ï¼Œåœ¨ç°ä»£è¯­è¨€ä¸­å®ƒè¢« Object.getPrototypeOf() å’Œ Object.setPrototypeOf æ‰€å–ä»£äº†ï¼Œä»–ä»¬çš„ç”¨å¤„æ˜¯ç›¸åŒçš„ã€‚æˆ‘ä»¬åç»­ä¼šè®¨è®ºè¿™ä¸¤ä¸ªå‡½æ•°å‡ºç°çš„åŸå› å’Œè¯¦ç»†çš„ç”¨æ³•ã€‚

- ECMA-262æ–‡æ¡£ä¸­è§„å®šï¼Œæµè§ˆå™¨ä¸­å¿…é¡»åŒ…å« `__proto__` ï¼Œäº‹å®ä¸Šæ‰€æœ‰çš„ç¯å¢ƒï¼ˆåŒ…æ‹¬æœåŠ¡å™¨ç«¯ï¼‰ä¹Ÿéƒ½æ”¯æŒå®ƒã€‚ç”±äº `__proto__` ç›¸æ¯”ä¹‹ä¸‹ç›´è§‰ä¸Šæ›´å®¹æ˜“è¢«æ¥å—ï¼Œæ‰€ä»¥ä»¥ä¸‹çš„ä¾‹å­ä¸­æˆ‘ä»¬éƒ½å°†ä½¿ç”¨å®ƒã€‚



- å¦‚æœæˆ‘ä»¬è¦ä½¿ç”¨ `rabbit` ä¸­çš„æŸä¸ªå±æ€§ï¼Œ`rabbit` ä¸­å´ä¸åŒ…å«è¿™ä¸ªå±æ€§ï¼Œé‚£ä¹ˆJavaScriptä¼šè‡ªåŠ¨æ‰¾åˆ° `animal` ä¸­çš„è¿™ä¸ªå±æ€§ã€‚
- ä¾‹å¦‚ï¼š

```javascript
// åŠ¨ç‰©
let animal = {
  eat: true
};

// å…”å…”ğŸ°
let rabbit = {
  jump: true
};

rabbit.__proto__ = animal; // (*)

// è¿™ä¸¤ä¸ªå±æ€§éƒ½å¯ä»¥åœ¨ rabbit ä¸­ä½¿ç”¨:
alert( rabbit.eat ); // true (**)
alert( rabbit.jump ); // true
```

- (*) è¿™ä¸€è¡Œè¡¨ç¤ºï¼Œæˆ‘ä»¬æ˜¾å¼åœ°å°† `animal`**å¯¹è±¡**æŒ‡å®šä¸º `rabbit`**å¯¹è±¡**çš„åŸå‹
- (**) è¿™ä¸€è¡Œä¸­ï¼Œ`alert()` å‡½æ•°å°è¯•è¯»å– `rabbit`å¯¹è±¡çš„ `eat`å±æ€§ï¼Œå®ƒä¸åœ¨ `rabbit`å¯¹è±¡ä¸­ï¼Œæ‰€ä»¥JavaScript ä¼šæ²¿ç€åŸå‹ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰å»æ‰¾ï¼Œå¹¶åœ¨`animal`**å¯¹è±¡**ä¸­æ‰¾åˆ°äº†è¿™ä¸ªå±æ€§ã€‚

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589437717763-8a6ee491-52fe-4038-99e6-796452774e80.png)

- æˆ‘ä»¬å¯ä»¥è¯´ `animalå¯¹è±¡` æ˜¯ `rabbitå¯¹è±¡` çš„åŸå‹ï¼Œæˆ–è€…è¯´ `rabbitå¯¹è±¡` æ˜¯ç”± `animalå¯¹è±¡` åŸºäºåŸå‹ç»§æ‰¿å¾—åˆ°çš„ã€‚
- å› æ­¤ï¼Œå¦‚æœ animalå¯¹è±¡ æœ‰è®¸å¤šæœ‰ç”¨çš„å±æ€§å’Œæ–¹æ³•ï¼Œä½ å¯ä»¥ç›´æ¥åœ¨ `rabbitå¯¹è±¡` ä¸­ä½¿ç”¨å®ƒä»¬ã€‚è¿™äº›å±æ€§æ˜¯â€œ**è¢«ç»§æ‰¿çš„**â€ã€‚

- å¦‚æœ `animalå¯¹è±¡` ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ `rabbitå¯¹è±¡` ä¸­å»è°ƒç”¨å®ƒã€‚

```javascript
// åŠ¨ç‰©
let animal = {
  eat: true,
  // NEW //
  walk() {
    alert("Animal walk");
  }
  // NEW //
};

// å…”å…”ğŸ°
let rabbit = {
  jump: true,
  __proto__: animal
};

// rabbitå¯¹è±¡çš„walkæ˜¯ä»åŸå‹ä¸­ç»§æ‰¿æ¥çš„
rabbit.walk(); // Animal walk
```

- ç»§æ‰¿çš„**æ–¹æ³•**ä¼šè‡ªåŠ¨ä»åŸå‹ä¸­å¸çº³è¿‡æ¥ï¼Œä¾‹å¦‚ï¼š

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589437920555-e8c67dbd-22d8-434f-9516-cb32cb8bbd2e.png)

- åŸå‹é“¾è¿˜å¯ä»¥æ›´é•¿ä¸€äº›ã€‚

```javascript
// åŠ¨ç‰©
let animal = {
  eat: true,
  walk() {
    alert("Animal walk");
  }
};

// å…”å…”ğŸ°
let rabbit = {
  jump: true,
  __proto__: animal
};

// é•¿è€³å…”å…”ğŸ°
let longEarRabbit = {
  earLength: 10,
  __proto__: rabbit
};

// walkæ–¹æ³•ä»åŸå‹é“¾ä¸Šç»§æ‰¿
longEar.walk(); // Animal walk
alert(longEar.jumps); // true (from rabbit)
```

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589439319852-083bb0b6-c865-4faf-abe1-3c1f0a173316.png)

- é™åˆ¶æœ‰äºŒï¼š

- - è¿™ç§åŸå‹**é“¾**ä¸å¯ä»¥æˆ**ç¯**ã€‚å¦‚æœæˆ‘ä»¬è¯•å›¾è¿™æ ·åšçš„è¯ï¼Œå°±ä¼šæŠ¥é”™ï¼›
  - __proto__ çš„å€¼åªèƒ½ä¸ºå¯¹è±¡æˆ–nullï¼Œå…¶ä»–ç±»å‹çš„å€¼ä¼šè¢«è‡ªåŠ¨å¿½ç•¥ï¼›

- å¦å¤–ï¼Œæ˜¾ç„¶æ¯ä¸ªå¯¹è±¡åªèƒ½æœ‰ä¸€ä¸ªåŸå‹â˜ï¸ã€‚



### æ·»åŠ å±æ€§ä¸ä¼šå½±å“åŸå‹

- åŸå‹åªä¼šåœ¨è¯»å±æ€§çš„æ—¶å€™å±•ç°å®ƒçš„é­…åŠ›ã€‚
- æ·»åŠ æˆ–è€…åˆ é™¤å±æ€§åªä¼šå½±å“å½“å‰å¯¹è±¡ï¼Œä¸ä¼šå½±å“å®ƒçš„åŸå‹ã€‚

- åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ç»™ `rabbitå¯¹è±¡` æ·»åŠ ä¸€ä¸ªå®ƒè‡ªå·±çš„ `walk()æ–¹æ³•`ã€‚

```javascript
// åŠ¨ç‰©
let animal = {
  eat: true,
  walk() {
    /* this method won't be used by rabbit */
  }
};

// å…”å…”ğŸ°
let rabbit = {
  __proto__: animal
};

// ç»™rabbitå¯¹è±¡åŠ ä¸€ä¸ªå®ƒè‡ªå·±çš„walk()æ–¹æ³•
rabbit.walk = function() {
  alert("Rabbit! Bounce-bounce!");
};

rabbit.walk(); 		// Rabbit! Bounce-bounce!
```

- è¿™æ ·çš„è¯ï¼Œåœ¨æ‰§è¡Œ `rabbit.walk()` æ—¶ï¼Œå°±ä¼šç«‹å³æ‰¾åˆ° `rabbitå¯¹è±¡` è‡ªèº«çš„ `walk()` æ–¹æ³•ï¼Œè€Œä¸ä¼šå»åŸå‹é“¾ä¸Šå¯»æ‰¾ã€‚

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589440359368-9ee92a23-5b81-4afb-b30c-bcef8b06601d.png)

- è®¿é—®å™¨å±æ€§æ˜¯ä¸ªä¾‹å¤–ï¼Œèµ‹å€¼ä¼šé€šè¿‡setterå‡½æ•°æ¥æ‰§è¡Œã€‚æ‰€ä»¥é€šè¿‡setterä¸ºæŸä¸ªå±æ€§èµ‹å€¼å®é™…ä¸Šç›¸å½“äºè°ƒç”¨äº†ä¸€ä¸ªå‡½æ•°ã€‚
- å› æ­¤ï¼Œ `admin.fullName` åœ¨ä¸‹é¢è¿™æ®µä»£ç ä¸­å¯ä»¥æ­£å¸¸è¿è¡Œã€‚

```javascript
let user = {
  name: "John",
  surname: "Smith",

  set fullName(value) {
    [this.name, this.surname] = value.split(" ");
  },

  get fullName() {
    return `${this.name} ${this.surname}`;
  }
};

let admin = {
  __proto__: user,
  isAdmin: true
};

alert(admin.fullName); // John Smith (*)

// setter triggers!
admin.fullName = "Alice Cooper"; // (**)
```

- åœ¨(*)è¿™ä¸€è¡Œä¸­ï¼Œadmin.fullName è¿™ä¸ªå±æ€§åœ¨å®ƒçš„åŸå‹userä¸­æœ‰ä¸€ä¸ªgetterï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«è°ƒç”¨ã€‚
- åœ¨(**)è¿™ä¸€è¡Œä¸­ï¼Œè¿™ä¸ªå±æ€§åœ¨å®ƒçš„åŸå‹userä¸­æœ‰ä¸€ä¸ªsetterï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«è°ƒç”¨ã€‚



### this çš„ç»‘å®šå€¼

- çœ‹å®Œä¸Šé¢çš„ä¾‹å­åï¼Œä¸€ä¸ªæœ‰æ„æ€çš„é—®é¢˜å‡ºç°äº†ã€‚é‚£å°±æ˜¯ `set fullName(value)` å‡½æ•°ä¸­ `this` çš„å€¼æ˜¯å•¥ï¼Ÿ`this.name` å’Œ `this.surname` å†™å…¥åˆ°å“ªä¸ªå¯¹è±¡ä¸­äº†ï¼Ÿuserå¯¹è±¡ è¿˜æ˜¯ adminå¯¹è±¡ï¼Ÿ
- ç­”æ¡ˆå¾ˆç®€å•ï¼Œthis å¹¶ä¸ä¼šæ”¶åˆ°åŸå‹ç»§æ‰¿çš„å½±å“ã€‚

- æ— è®ºæ–¹æ³•æ˜¯åœ¨ä¸€ä¸ªå¯¹è±¡è¿˜æ˜¯å®ƒçš„åŸå‹ä¸­å®šä¹‰çš„ï¼Œ`this` çš„å€¼æ°¸è¿œéƒ½æ˜¯`.`å‰é¢çš„é‚£ä¸ªå¯¹è±¡ã€‚
- æ‰€ä»¥ï¼Œ`setter` å‡½æ•°åœ¨è¢«è°ƒç”¨æ—¶ï¼Œ`admin.fullName=` ä¸­ `this` ç»‘å®šäº† `admin` è¿™ä¸ªå¯¹è±¡ï¼Œè€Œä¸æ˜¯ `user`å¯¹è±¡ã€‚

- è¿™æ˜¯è‡³å…³é‡è¦çš„ä¸€ä»¶äº‹ã€‚å¯èƒ½å­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„å¯¹è±¡ï¼Œå¯¹è±¡ä¸­æœ‰å¾ˆå¤šæ–¹æ³•ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡è¿˜æ˜¯å…¶ä»–å¯¹è±¡çš„åŸå‹ã€‚å½“å…¶ä»–å¯¹è±¡åœ¨è°ƒç”¨ç»§æ‰¿è€Œæ¥çš„æ–¹æ³•æ—¶ï¼Œä»–ä»¬ä»…ä»…ä¼šä¿®æ”¹è‡ªå·±çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯åŸå‹çš„çŠ¶æ€ã€‚
- ä¾‹å¦‚ï¼Œä¸‹é¢çš„ä»£ç ä¸­ï¼Œanimalå¯¹è±¡ä½œä¸ºä¸€ä¸ªâ€œæ–¹æ³•åº“â€ï¼Œrabbitå¯¹è±¡å¯ä»¥è‡ªç”±æ»´ä½¿ç”¨ç»§æ‰¿æ¥çš„æ–¹æ³•ã€‚

- è°ƒç”¨ `rabbit.sleep()` ä¼šä¿®æ”¹ `rabbit` å¯¹è±¡ä¸­çš„ `this.isSleeping` å±æ€§ã€‚

```javascript
// animal has methods
let animal = {
  walk() {
    if (!this.isSleeping) {
      alert(`I walk`);
    }
  },
  sleep() {
    this.isSleeping = true;
  }
};

let rabbit = {
  name: "å…”å…”ğŸ°",
  __proto__: animal
};

// ä¿®æ”¹rabbitå¯¹è±¡çš„isSleepingå±æ€§
rabbit.sleep();

alert(rabbit.isSleeping); // true
alert(animal.isSleeping); // undefined (no such property in the prototype)
```

- è¿è¡Œåçš„ç»“æœç¤ºæ„å›¾ï¼š

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589447368043-74e56b2e-7b15-4c39-8bde-343823b687ad.png)

- å¦‚æœæˆ‘ä»¬è¿˜æœ‰ä¸€äº›å…¶ä»–çš„ç»§æ‰¿è‡ª `animal` å¯¹è±¡çš„å¯¹è±¡ï¼Œä¾‹å¦‚é¸ŸğŸ¦ã€è›‡ğŸç­‰ç­‰ï¼Œä»–ä»¬ä¹Ÿå¯ä»¥è®¿é—®åˆ° `animal` å¯¹è±¡çš„å„ç§æ–¹æ³•ã€‚ä½†æ˜¯åœ¨è°ƒç”¨æ–¹æ³•æ—¶thisä¼šåœ¨è°ƒç”¨æ—¶ç»‘å®šåˆ°è°ƒç”¨å®ƒçš„å¯¹è±¡æœ¬èº«ï¼ˆè€Œä¸æ˜¯å®ƒçš„åŸå‹ `animal` ï¼‰
- æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨thisä¿®æ”¹å±æ€§æ—¶ï¼Œæ”¹å˜çš„æ˜¯å¯¹è±¡æœ¬èº«çš„å±æ€§ï¼ˆè€Œä¸æ˜¯å®ƒçš„åŸå‹çš„ï¼‰ã€‚

- æ€»è€Œè¨€ä¹‹ï¼Œæ–¹æ³•å¯ä»¥å…±äº«ï¼Œä½†æ˜¯å¯¹è±¡çš„çŠ¶æ€ä¸ä¼šã€‚



### for...in å¾ªç¯

- for...inå¾ªç¯ä¹Ÿä¼šè®¿é—®ç»§æ‰¿çš„å±æ€§ï¼Œ ä¾‹å¦‚ï¼š

```javascript
let animal = {
  eat: true
};

let rabbit = {
  jump: true,
  __proto__: animal
};

// Object.keys åªä¼šè¿”å›å®ƒè‡ªå·±çš„å±æ€§
alert(Object.keys(rabbit)); // jump

// for..in å¾ªç¯ä¸ä»…ä¼šè¿”å›è‡ªå·±çš„å±æ€§ï¼Œè¿˜ä¼šè¿”å›ç»§æ‰¿çš„å±æ€§
for(let prop in rabbit) alert(prop); // jump, then eat
```

- å¦‚æœä½ ä¸å¸Œæœ›å¦‚æ­¤ï¼Œæˆ‘ä»¬æƒ³è¦æ’é™¤é‚£äº›ç»§æ‰¿æ¥çš„å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªåä¸º `obj.hasOwnProperty(key)`çš„æ–¹æ³•ã€‚å¦‚æœobjè‡ªèº«æœ‰åä¸º key çš„å±æ€§ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ª `true`ã€‚
- è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥è¿‡æ»¤æ‰é‚£äº›ç»§æ‰¿æ¥çš„å±æ€§ï¼ˆæˆ–è€…å¯¹ä»–ä»¬è¿›è¡Œä¸€äº›ç‰¹åˆ«çš„æ“ä½œï¼‰ã€‚

```javascript
let animal = {
  eat: true
};

let rabbit = {
  jump: true,
  __proto__: animal
};

for(let prop in rabbit) {
  let isOwn = rabbit.hasOwnProperty(prop);

  if (isOwn) {
    alert(`Our: ${prop}`); // Our: jumps
  } else {
    alert(`Inherited: ${prop}`); // Inherited: eats
  }
}
```

- ç°åœ¨æœ‰å¦‚ä¸‹å›¾æ‰€ç¤ºçš„ä¸€æ¡ç»§æ‰¿é“¾ï¼šrabbitå¯¹è±¡ ç”± animalå¯¹è±¡ç»§æ‰¿è€Œæ¥ï¼Œanimalå¯¹è±¡ç”±Object.prototypeç»§æ‰¿è€Œæ¥ï¼ŒObject.ptototype çš„åŸå‹æ˜¯nullã€‚

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589460660906-588054c5-a066-4329-a29f-d28c734a6328.png)

- æ³¨æ„ï¼Œæœ‰è¶£çš„äº‹æƒ…æ¥äº†ã€‚rabbit.hasOwnPropertyè¿™ä¸ªå±æ€§ä»å“ªæ¥å‘¢ï¼Ÿæˆ‘ä»¬å¹¶æ²¡æœ‰å®šä¹‰å®ƒã€‚çœ‹çœ‹åŸå‹é“¾æˆ‘ä»¬ä¼šå‘ç°è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ Object.prototype.hasOwnProperty å®šä¹‰çš„ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯ç»§æ‰¿æ¥çš„ã€‚
- ä½†æ˜¯ï¼Œå¦‚æœ `for...in` å¾ªç¯ä¹Ÿæ˜¯åˆ—å‡ºç»§æ‰¿çš„å±æ€§çš„è¯ï¼Œä¸ºä»€ä¹ˆ `hasOwnProperty` æ²¡æœ‰åƒ `eat` å’Œ `jump`ä¸€æ ·æ²¡æœ‰å‡ºç°åœ¨ `for...in` å¾ªç¯ä¸­å‘¢ï¼Ÿ

- ç­”æ¡ˆå¾ˆç®€å•ï¼šå®ƒæ˜¯ä¸å¯åˆ—ä¸¾çš„ã€‚è·Ÿè®¸å¤šObject.prototypeä¸€æ ·ï¼Œå®ƒæœ‰ä¸€ä¸ª `enumerable: false`ï¼ˆä¸å¯åˆ—ä¸¾ï¼‰æ ‡è¯†ã€‚è€Œ for...in å¾ªç¯åªä¼šåˆ—ä¸¾å‡º enumerable å€¼ä¸ºçœŸçš„å±æ€§ã€‚è¿™å°±æ˜¯Object.prototypeä¸­çš„å±æ€§æ²¡æœ‰è¢«åˆ—ä¸¾å‡ºæ¥çš„åŸå› ã€‚

åŸºæœ¬æ‰€æœ‰å…¶ä»–çš„ç”¨äºè·å–é”®å€¼çš„æ–¹æ³•éƒ½ä¼šå¿½ç•¥ç»§æ‰¿è€Œæ¥çš„å±æ€§

åŸºæœ¬ä¸Šæ‰€æœ‰çš„ç”¨äºè·å–é”®å€¼çš„æ–¹æ³•éƒ½ä¼šå¿½ç•¥ç»§æ‰¿è€Œæ¥çš„å±æ€§ï¼Œä¾‹å¦‚ `Object.keys`ï¼Œ`Object.values`ã€‚

ä»–ä»¬åªä¼šå»æ“ä½œè¿™ä¸ªå¯¹è±¡æœ¬èº«ï¼Œè€Œä¸ä¼šå»å…³å¿ƒåŸå‹ã€‚

### å°ç»“

- åœ¨JavaScriptä¸­ï¼Œæ‰€æœ‰çš„å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªéšè—å±æ€§ `[[prototype]]`ï¼Œå®ƒçš„å€¼ä¸ºå¦ä¸€ä¸ªå¯¹è±¡æˆ–è€… `null`ï¼›
- æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `obj.__proto__` æ¥è·å–å®ƒçš„å€¼ï¼›

- `[[prototype]]` å±æ€§ä¸­å¼•ç”¨çš„å¯¹è±¡è¢«ç§°ä¸º**åŸå‹ï¼›**
- æˆ‘ä»¬è¯•å›¾è®¿é—®ä¸€ä¸ªå¯¹è±¡çš„æŸä¸ªå±æ€§æˆ–è€…è°ƒç”¨æŸä¸ªæ–¹æ³•æ—¶ï¼Œå®ƒå½“å‰å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„è¯ï¼ŒJavaScriptä¼šè¯•å›¾ä»åŸå‹ä¸­å»å¯»æ‰¾ï¼›

- ä¿®æ”¹æˆ–è€…åˆ é™¤æŸä¸ªå±æ€§åªä¼šå¯¹äºå½“å‰å¯¹è±¡ç”Ÿæ•ˆï¼Œè€Œä¸ä¼šå¯¹å®ƒçš„åŸå‹äº§ç”Ÿå½±å“ï¼›
- å¦‚æœæˆ‘ä»¬è°ƒç”¨å¯¹è±¡çš„æŸä¸ªæ–¹æ³•ï¼Œè€Œè¿™ä¸ªæ–¹æ³•æ˜¯ä»åŸå‹ä¸­ç»§æ‰¿è€Œæ¥çš„ï¼Œthisä»ç„¶ä¼šç»‘å®šåˆ°å½“å‰å¯¹è±¡ä¸Šã€‚æ‰€ä»¥å³ä½¿æ˜¯ç»§æ‰¿è€Œæ¥çš„æ–¹æ³•ä¹Ÿåªä¼šå¯¹å½“å‰å¯¹è±¡è¿›è¡Œæ“ä½œã€‚

- for...in å¾ªç¯æ—¢ä¼šéå†è‡ªèº«çš„å±æ€§ï¼Œä¹Ÿä¼šéå†ï¼ˆä»åŸå‹ä¸­ï¼‰ç»§æ‰¿è€Œæ¥çš„å±æ€§ã€‚å…¶ä»–çš„ç”¨äºè·å–é”®å€¼çš„æ–¹æ³•åŸºæœ¬ä¸Šåªä¼šæ“ä½œè‡ªèº«çš„å±æ€§ã€‚



## åŸºäºClassçš„ç»§æ‰¿

- åŸºäºClassçš„ç»§æ‰¿å¯ä»¥å°†ä¸€ä¸ªclassæ‰©å±•ä¸ºå¦ä¸€ä¸ªclassï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ–°çš„classä¸­æ·»åŠ æ–°çš„æ–¹æ³•ã€‚

### extendså…³é”®è¯

- ä¾‹å¦‚ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªAnimalç±»

```javascript
class Animal {
  constructor(name) {
    this.speed = 0;
    this.name = name;
  }
  run(speed) {
    this.speed = speed;
    alert(`${this.name} runs with speed ${this.speed}.`);
  }
  stop() {
    this.speed = 0;
    alert(`${this.name} stands still.`);
  }
}

let animal = new Animal("My animal");
```

- `animal`å¯¹è±¡å’Œ `Animal`ç±»çš„å…³ç³»å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589471500339-a7d2a89c-bfcf-487a-9c97-cce0ae79e290.png)

- ç°åœ¨æˆ‘ä»¬æƒ³è¦åˆ›å»ºå¦å¤–ä¸€ä¸ª `Rabbit`ç±»
- å› ä¸ºå…”å…”ä¹Ÿæ˜¯åŠ¨ç‰©çš„ä¸€ç§ï¼Œæ‰€ä»¥Rabbitç±»éœ€è¦åŸºäºAnimalç±»ï¼Œå¹¶å¯ä»¥è®¿é—®Animalç±»çš„æ–¹æ³•ã€‚è¿™æ ·çš„è¯å…”å…”å°±å¯ä»¥åšæ‰€æœ‰åŠ¨ç‰©éƒ½èƒ½åšçš„äº‹æƒ…ï¼ˆåƒå–æ‹‰æ’’ç¡ï¼‰

- æ‰©å±•ä¸€ä¸ªç±»çš„è¯­æ³•æ˜¯ï¼š`class Child extends Parent`
- æˆ‘ä»¬ä¸€èµ·åˆ›å»ºä¸€ä¸ªç”± `Animal`ç±»ç»§æ‰¿è€Œæ¥çš„ `Rabbit`ç±»å§ï¼

```javascript
class Rabbit extends Animal {
  hide() {
    alert(`${this.name} hides!`);
  }
}

let rabbit = new Rabbit("White Rabbit");

rabbit.run(5); // ğŸ‡å°ç™½å…”åœ¨å¥”è·‘
rabbit.hide(); // ğŸ°å°ç™½å…”è—èµ·æ¥äº†ï¼
```

- `Rabbit`ç±»å®ä¾‹åŒ–çš„å¯¹è±¡æ—¢æ‹¥æœ‰ Rabbitç±»çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `rabbit.hide()`ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨`Animal`ç±»çš„æ–¹æ³•ï¼Œä¾‹å¦‚ `rabbit.run()`ã€‚
- æœ¬è´¨ä¸Šï¼Œextends å…³é”®å­—ä»ç„¶åœ¨ä½¿ç”¨åŸå‹æœºåˆ¶çš„æŠ€å·§ï¼Œå®ƒå°† `Rabbit.prototype.[[prototype]]` çš„å€¼è®¾ç½®ä¸º `Animal.prototype` ã€‚è¿™æ ·çš„è¯ï¼Œå¦‚æœåœ¨ Rabbit.prototype ä¸­æ²¡æœ‰æ‰¾åˆ°æŸä¸ªæ–¹æ³•ï¼Œå°±ä¼šç»§ç»­åˆ°`Animal.prototype` ä¸­å»å¯»æ‰¾ã€‚

![img](https://zhuye-1308301598.file.myqcloud.com/markdown/1589471944070-5eaa898f-6ff9-4412-be1a-f1c0d310bc96.png)



- ä¾‹å¦‚ï¼Œä¸ºäº†æ‰¾åˆ° rabbit.run è¿™ä¸ªæ–¹æ³•ï¼Œå¼•æ“ä¼šé€ä¸€å»ä»¥ä¸‹å‡ ä¸ªåœ°æ–¹æŸ¥æ‰¾ï¼š

- - `rabbit`å¯¹è±¡ï¼ˆæ²¡æœ‰ `run` æ–¹æ³•ï¼‰
  - `rabbit`å¯¹è±¡çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯ `Rabbit.prototype`ï¼ˆä»ç„¶æ²¡æœ‰ `run` æ–¹æ³•ï¼‰

- - Rabbit.prototypeå¯¹è±¡çš„åŸå‹ï¼Œä¹Ÿå°±æ˜¯ `Animal.prototype`ï¼ˆç»ˆäºæ‰¾åˆ°äº† `run` æ–¹æ³•ï¼‰



### é‡å†™æŸä¸ªæ–¹æ³•

- ç°åœ¨è®©æˆ‘ä»¬å†è¿›ä¸€æ­¥ï¼Œé‡å†™ç±»ä¸­æŸä¸ªæ–¹æ³•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰æ²¡æœ‰åœ¨ `Rabbit`ç±»ä¸­æ˜ç¡®å®šä¹‰çš„æ–¹æ³•éƒ½ä¼šä½¿ç”¨`Animal`ç±»ä¸­çš„å®šä¹‰ã€‚
- å¦‚æœæˆ‘ä»¬åœ¨Rabbitç±»ä¸­å®šä¹‰äº†æŸä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆä»–å°±ä¼šä¼˜å…ˆè¢«ä½¿ç”¨ã€‚

- é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¹¶ä¸æƒ³å½»åº•æ›¿æ¢æŸä¸ªçˆ¶ç±»çš„æ–¹æ³•ï¼Œè€Œåªæ˜¯å¯¹å®ƒè¿›è¡Œä¸€äº›è°ƒæ•´æˆ–è€…æ‹“å±•å®ƒçš„åŠŸèƒ½ã€‚æˆ‘ä»¬å…ˆåœ¨è‡ªå·±å†™çš„æ–¹æ³•ä¸­å®ç°ä¸€äº›åŠŸèƒ½ï¼Œç„¶åå†å»è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ã€‚
- ç±»æä¾›äº† `super` å…³é”®å­—æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚

- - ä½¿ç”¨ `super.method(...)` è°ƒç”¨ä¸€ä¸ªçˆ¶ç±»æ–¹æ³•ï¼›
  - ä½¿ç”¨ `super(...)` è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼›

- ä¾‹å¦‚ä»¥ä¸‹ä¸€æ®µä»£ç 

```javascript
class Animal {
	// æ„é€ å™¨
  constructor(name) {
    this.speed = 0;
    this.name = name;
  }

  run(speed) {
    this.speed = speed;
    alert(`${this.name} runs with speed ${this.speed}.`);
  }

  stop() {
    this.speed = 0;
    alert(`${this.name} stands still.`);
  }

}

class Rabbit extends Animal {
  hide() {
    alert(`${this.name} hides!`);
  }
	
  stop() {
    super.stop(); // è°ƒç”¨çˆ¶ç±»çš„stopæ–¹æ³•ï¼Œå…”å…”ğŸ°ä¼šç«™ä½
    this.hide(); // å…”å…”ğŸ°ä¼šè—èµ·æ¥ï¼
  }
}

let rabbit = new Rabbit("White Rabbit");

rabbit.run(5); // å…”å…”ğŸ°åœ¨è·‘
rabbit.stop(); // å…”å…”ğŸ°å…ˆç«™ä½äº†ï¼Œç„¶åè—èµ·æ¥äº†ï¼
```

ç®­å¤´å‡½æ•°æ²¡æœ‰ super



### é‡å†™æ„é€ å™¨

- å¯¹äºæ„é€ å™¨æ¥è¯´ï¼Œè¦é‡å†™å®ƒæœ‰ä¸€ç‚¹å°å¤æ‚ã€‚
- é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªç»§æ‰¿è‡ªå…¶ä»–ç±»çš„ç±»æ²¡æœ‰è‡ªå·±çš„æ„é€ å™¨ï¼Œåˆ™ä¼šä¸ºå®ƒè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªâ€œç©ºâ€çš„æ„é€ å™¨ï¼š

```javascript
class Rabbit extends Animal {
  // æ²¡æœ‰è‡ªå·±æ„é€ å™¨çš„ç±»ä¼šç”Ÿæˆä¸€ä¸ªé»˜è®¤çš„æ„é€ å™¨
  constructor(...args) {
    super(...args);
  }
}
```

- éœ€è¦å…ˆä½¿ç”¨ `super`ï¼Œæ‰èƒ½ä½¿ç”¨ `this`ã€‚

```javascript
class Animal {

  constructor(name) {
    this.speed = 0;
    this.name = name;
  }
  
  // ...
}

class Rabbit extends Animal {

  constructor(name, earLength) {
    super(name);									// å…ˆä½¿ç”¨super
    this.earLength = earLength;		// æ‰èƒ½ä½¿ç”¨this
  }

  // ...
}

// now fine
let rabbit = new Rabbit("White Rabbit", 10);
alert(rabbit.name); // White Rabbit
alert(rabbit.earLength); // 10
```



### å°ç»“

- è¦æ‰©å±•ä¸€ä¸ªç±»ï¼Œéœ€è¦ä½¿ç”¨è¯­æ³•ï¼š`class Child extends Parent`ï¼š

- - è¿™æ„å‘³ç€ï¼Œ`Child.prototype.__proto__=== Parent.prototype`ï¼›

- å½“æˆ‘ä»¬è¦é‡å†™ä¸€ä¸ªæ„é€ å™¨ï¼ˆconstructorï¼‰æ—¶ï¼š

- - æˆ‘ä»¬å¿…é¡»åœ¨å­ç±»çš„æ„é€ å™¨ï¼ˆconstructorï¼‰ä¸­ä½¿ç”¨ super è°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨thisï¼›

- å½“æˆ‘ä»¬è¦é‡å†™ä¸€ä¸ªæ–¹æ³•æ—¶ï¼š

- - æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `super.method()`ï¼Œè°ƒç”¨çˆ¶ç±»çš„åŒåæ–¹æ³•ï¼›

- ç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„ `this` å’Œ `super`ï¼›
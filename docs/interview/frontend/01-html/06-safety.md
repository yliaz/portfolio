---
title: 网络安全
---

# 网络安全

## 1. CSRF 攻击是什么？如何防范？
**是什么：**
CSRF（Cross-site request forgery），中文名称：跨站请求伪造。攻击者盗用了你的身份，以你的名义发送恶意请求。

CSRF 能够做的事情包括：以你名义发送邮件，发消息，盗取你的账号，甚至于购买商品，虚拟货币转账......造成的问题包括：个人隐私泄露以及财产安全。例如通过 QQ 等聊天软件发送的链接(有些还伪装成短域名，用户无法分辨)，攻击者就能迫使 Web 应用的用户去执行攻击者预设的操作。例如，当用户登录网络银行去查看其存款余额，在他没有退出时，就点击了一个 QQ 好友发来的链接，那么该用户银行帐户中的资金就有可能被转移到攻击者指定的帐户中。


**如何防范：**
> 采用 `anti-csrf-token` 方案。

① 服务端在收到路由请求时，生成一个随机数，在渲染请求页面时把随机数埋入页面（一般埋入 form 表单内， `<input type="hidden" name="_csrf_token" value="xxxx">` ）；

② 服务端设置 setCookie，把该随机数作为 Cookie 或者 Session 种入用户浏览器；

③ 当用户发送 GET 或者 POST 请求时带上 `_csrf_token` 参数（对于 form 表单直接提交即可，因为会自动把当前表单内所有的 input 提交给后台，包括 `_csrf_token` ）；

④ 后台在接受到请求后解析请求的 Cookie 获取 `_csrf_token` 的值，然后和用户请求提交的 `_csrf_token` 做个比较，如果相等表示请求是合法的。

## 2. 网页验证码是干嘛的？是为了解决什么安全问题？
1. 区分用户是计算机还是人的公共全自动程序，可以防止恶意破解密码、刷票、论坛灌水。

2. 有效防止黑客对某一个特定注册用户用特定程序暴力破解方式进行不断的登陆尝试。

## 3. 常见 Web 安全及防护原理？
### SQL 注入原理
通过把 SQL 命令插入到 Web 表单递交或输入域名或页面请求的查询字符串，最终达到欺骗服务器执行恶意的 SQL 命令。

总的来说有以下几点：
- 永远不要信任用户的输入，要对用户的输入进行校验，可以通过正则表达式，或限制长度，对单引号和双 - 进行转换等。
- 永远不要使用动态拼装 SQL，可以使用参数化的 SQL 或者直接使用存储过程进行数据查询存取。
- 永远不要使用管理员权限的数据库连接，为每个应用使用单独的权限有限的数据库连接。
- 不要把机密信息明文存放，请加密或者 Hash 掉密码和敏感的信息。


### XSS 原理及防范：
XSS（Cross-site scripting攻击）指的是攻击者往 Web 页面里插入恶意 HTML 标签或者 JavaScript 代码。比如：攻击者在论坛中放一个看似安全的链接，骗取用户点击后，窃取 Cookie 中的用户私密信息；或者攻击者在论坛中加一个恶意表单，当用户提交表单的时候，却把信息传送到攻击者的服务器中，而不是用户原本以为的信任站点。


### XSS 防范方法：
- 首先，代码里对用户输入的地方和变量都需要仔细检查长度和对 < ， > ， ; ， ’ 等字符做过滤；
- 其次，任何内容写到页面之前都必须加以 Encode，避免不小心把 HTML Tag 弄出来。这一个层面做好，至少可以堵住超过一半的 XSS 攻击。


### XSS 与 CSRF 有什么区别吗？
XSS 是获取信息，不需要提前知道其他用户页面的代码和数据包。

CSRF 是代替用户完成指定的动作，需要知道其他用户页面的代码和数据包。要完成一次 CSRF 攻击，受害者必须依次完成两个步骤：
1. 登录受信任网站 A，并在本地生成 Cookie。
2. 在不登出 A 的情况下，访问危险网站 B。


### CSRF 的防御：
服务端的 CSRF 方式方法很多样，但总的思想都是一致的，就是在客户端页面增加伪随机数。
通过验证码的方法。